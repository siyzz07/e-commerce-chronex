<!DOCTYPE HTML>
<html lang="en">


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/page-categories.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:33:21 GMT -->
<head>
    <meta charset="utf-8">
    <title>chronex</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">

  <!-- SheetJS for Excel export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <!-- Favicon -->
    <!-- <link rel="shortcut icon" type="image/x-icon" href="assets/imgs/theme/favicon.svg"> -->
    <!-- Template CSS -->
    <link href="assets/css/main.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <div class="screen-overlay"></div>
    <aside class="navbar-aside" id="offcanvas_aside">
      <div class="aside-top">
        <a href="index.html" class="brand-wrap">
          <img
            src="images/logo_image.png"
            class="logo"
            alt="Evara Dashboard"
          />
        </a>
        <div>
          <button class="btn btn-icon btn-aside-minimize">
            <i class="text-muted material-icons md-menu_open"></i>
          </button>
        </div>
      </div>
      <nav>
        <ul class="menu-aside">
          <li class="menu-item">
            <a class="menu-link" href="dashboard">
              <i class="icon material-icons md-home"></i>
              <span class="text">Dashboard</span>
            </a>
          </li>
          <li class="menu-item ">
            <a class="menu-link" href="/admin/product">
              <i class="icon material-icons md-shopping_bag"></i>
              <span class="text">Products</span>
            </a>
            
          </li>
          <li class="menu-item ">
            <a class="menu-link" href="orderList">
              <i class="icon material-icons md-shopping_cart"></i>
              <span class="text">Orders</span>
            </a>
            </li>
            <li class="menu-item ">
                <a class="menu-link" href="userdata">
                  <i class="icon material-icons md-person"></i>
                  <span class="text">Users</span>
                </a>
              </li>
              <li class="menu-item ">
                <a class="menu-link" href="category">
                  <i class="icon material-icons md-add_box"></i>
                  <span class="text"> Catagories</span>
                </a>

              </li>
              <li class="menu-item ">
                <a class="menu-link" href="brand">
                  <i class="icon material-icons md-stars"></i>
                  <span class="text">Brand</span>
                </a>
              </li>
              <li class="menu-item ">
                <a class="menu-link" href="offer">
                  <i class="icon material-icons md-monetization_on"></i>
                  <span class="text">Offers</span>
                </a>
               
              </li>
              <li class="menu-item  ">
                <a class="menu-link" href="coupen">
                  <i class="icon material-icons md-monetization_on"></i>
                  <span class="text">Coupen</span>
                </a>
               
              </li>
              <li class="menu-item ">
                <a class="menu-link" href="#">
                  <i class="icon material-icons md-person"></i>
                  <span class="text">Banners</span>
                </a>
              </li>
              <li class="menu-item active ">
                <a class="menu-link" href="#">
                    <i class="icon material-icons md-store"></i>
                  <span class="text">Sales Report</span>
                </a>
              </li>
        </ul>
      
       
        <br />
        <br />
      </nav>
    </aside>

    <main class="main-wrap">
      <header class="main-header navbar">
        <div class="col-search">
          <form class="searchform">
            <!-- <div class="input-group">
              <input
                list="search_terms"
                type="text"
                class="form-control"
                placeholder="Search term"
              />
              <button class="btn btn-light bg" type="button">
                <i class="material-icons md-search"></i>
              </button>
            </div> -->
            <datalist id="search_terms">
              <option value="Products"></option>
              <option value="New orders"></option>
              <option value="Apple iphone"></option>
              <option value="Ahmed Hassan"></option>
            </datalist>
          </form>
        </div>
        
           
            <li>
              <a class="" href="logout"> <i class="material-icons md-exit_to_app"></i>Logout</a>
            </li>
          </ul>
        </div>
      </header>
        <section class="content-main">
            <div class="content-header">
                <div>
                    <h2 class="content-title card-title">Sales Report</h2>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    
                    <div style="display: flex;" class="card mb-4">
                        <header class="card-header">
                            <div style="display: flex; gap: 20px;">
                                <!-- Date Range Section -->

                               
                                <div style="width: 50%;">
                                    <div class="col-md-3 col-6">
                                        <select class="form-select" id="report-type" onchange="toggleDateFields()">
                                            <option value="All" <% if(reportType == 'All'){ %>selected<% } %>>All</option>
                                            <option value="Weekly" <% if(reportType == 'Weekly'){ %>selected<% } %>>Weekly</option>
                                            <option value="Monthly" <% if(reportType == 'Monthly'){ %>selected<% } %> >Monthly</option>
                                            <option value="Yearly" <% if(reportType == 'Yearly'){ %>selected<% } %>>Yearly</option>
                                            <option value="custom"<% if(reportType == 'Custom date'){ %>selected<% } %>>Custom date</option>
                                        </select>
                                    </div>
                                
                                    <!-- Custom date fields only shown when 'Custom date' is selected -->
                                    <div style="display: flex; gap: 10px; align-items: center; display: none;" id="custom-date-fields">
                                        <label for="start-date" class="form-label">Start Date</label>
                                        <input type="date" class="form-control" name="startDate" id="start-date">
                                
                                        <label for="end-date" class="form-label">End Date</label>
                                        <input type="date" class="form-control" name="endDate" id="end-date">
                                    </div>
                                    <br>
                                        <button type="submit" class="btn btn-primary" onclick="submitReportForm()">Submit</button>
                                </div>
                        
                                <!-- Status Select Section -->
                                <!-- <div style="width: 50%; display: none;" id="date-range">
                                    <div class="row gx-3">
                                        <div class="col-lg-12 col-md-12">
                                            <div class="mb-2">
                                                <div style="display: flex; gap: 10px; align-items: center;">
                                                    <label for="start-date" class="form-label">Start Date</label>
                                                    <input type="date" class="form-control" name="start-date" id="start-date">
                                
                                                    <label for="end-date" class="form-label">End Date</label>
                                                    <input type="date" class="form-control" name="end-date" id="end-date">
                                                </div>
                                                <div style="display: flex; align-items: center; justify-content: center; margin-top: 10px;">
                                                    <button type="submit" class="btn btn-primary">Submit</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div> -->
                                
                            </div>
                        </header>
                        <div class="row">
                            <div class="col-lg-3">
                                <div class="card card-body mb-4">
                                    <article class="icontext">
                                        <span class="icon icon-sm rounded-circle bg-primary-light"><i class="text-primary material-icons md-monetization_on"></i></span>
                                        <div class="text">
                                            <h6 class="mb-1 card-title">Toatal Amount</h6>
                                            <span><%=   totalAmount %></span>
                                            <span class="text-sm">
                                             
                                            </span>
                                        </div>
                                     
                                    </article>
                                </div>
                            </div>
                                    <div class="col-lg-3">
                                <div class="card card-body mb-4">
                                    <article class="icontext">
                                        <span class="icon icon-sm rounded-circle bg-info-light"><i class="text-info material-icons md-shopping_basket"></i></span>
                                        <div class="text">
                                            <h6 class="mb-1 card-title">Total Discount Given</h6> <span><%= totalDiscount  %></span>
                                            <span class="text-sm">
                                                <!-- Based in your local time. -->
                                            </span>
                                        </div>
                                    </article>
                                </div>
                            </div>
                            <div class="col-lg-3">
                                <div class="card card-body mb-4">
                                    <article class="icontext">
                                        <span class="icon icon-sm rounded-circle bg-success-light"><i class="text-success material-icons md-local_shipping"></i></span>
                                        <div class="text">
                                            <h6 class="mb-1 card-title">Orders</h6> <span><%=  totalOrders %></span>
                                            <span class="text-sm">
                                                Excluding orders in transit
                                            </span>
                                        </div>
                                    </article>
                                </div>
                            </div>
                            <div class="col-lg-3">
                                <div class="card card-body mb-4">
                                    <article class="icontext">
                                        <span class="icon icon-sm rounded-circle bg-warning-light"><i class="text-warning material-icons md-qr_code"></i></span>
                                        <div class="text">
                                            <h6 class="mb-1 card-title">Products</h6> <span><%= productsCount %></span>
                                            <span class="text-sm">
                                                <!-- In 19 Categories -->
                                            </span>
                                        </div>
                                    </article>
                                </div>
                            </div>
                    
                            <div class="col-lg-3">
                                <div class="card card-body mb-4">
                                    <article class="icontext">
                                        <span class="icon icon-sm rounded-circle bg-primary-light"><i class="text-primary material-icons md-monetization_on"></i></span>
                                        <div class="text">
                                            <h6 class="mb-1 card-title">Revenue</h6>
                                            <span><%= totalRevenue %></span>
                                            <span class="text-sm">
                                                
                                            </span>
                                        </div>
                                    </article>
                                </div>
                            </div>

                            
                            <div class="col-lg-3">
                                <div class="card card-body mb-4">
                                    <article class="icontext">
                                        <!-- <span class="icon icon-sm rounded-circle bg-primary-light"><i class="text-primary material-icons md-monetization_on"></i></span> -->
                                        <div class="text">
                                            <h6 class="mb-1 card-title">Cancelled orders</h6>
                                            <span><%= canceledOrderCount %></span>
                                            <span class="text-sm">
                                                
                                            </span>
                                        </div>
                                    </article>
                                </div>
                            </div>

                            <div class="col-lg-3">
                              <div class="card card-body mb-4">
                                  <article class="icontext">
                                      <!-- <span class="icon icon-sm rounded-circle bg-primary-light"><i class="text-primary material-icons md-monetization_on"></i></span> -->
                                      <div class="text">
                                          <h6 class="mb-1 card-title">Returned orders</h6>
                                          <span><%= returnedOrderCount %></span>
                                          <span class="text-sm">
                                              
                                          </span>
                                      </div>
                                  </article>
                              </div>
                          </div>
                        </div>
                        <div style="display: flex; justify-content: flex-end; gap: 10px;">
                            <div>
                               <button onclick="exportToPDF()" type="submit" class="btn btn-primary">Download as PDF</button>
                            </div>
                            <div>
                               <button onclick="exportToExcel()" type="submit" class="btn btn-primary">Download as Excel</button>
                            </div>
                         </div>
                         
                         <div class="card-body">
                            <div class="table-responsive">
                               <table class="table table-hover" id="report-table">
                                  <thead>
                                     <tr>
                                        <th style="width: 10%;">SiNo</th>
                                        <th style="width: 10%;">Orderer</th>
                                        <th style="width: 20%;">Email</th>
                                        <th style="width: 15%;">Date</th>
                                        <th style="width: 15%;">Discount</th>
                                        <th style="width: 15%;">Paid</th>
                                        <th style="width: 15%;">Method</th>
                                     </tr>
                                  </thead>
                                  <tbody>
                                     <% if(report.length === 0){ %>
                                        <td colspan="7">No records found for the specified criteria.</td>
                                     <% } else { %>
                                        <% for(i = 0; i < report.length; i++) { %>
                                           <tr>
                                              <td><%= i + 1 %></td>
                                              <td><%= report[i].userId.name %></td>
                                              <td><%= report[i].userId.email %></td>
                                              <td><%= report[i].orderDate.toLocaleDateString() %></td>
                                              <td><%= report[i].discount %></td>
                                              <td><%= report[i].totalWithDiscount %></td>
                                              <td><%= report[i].paymentMethod %></td>
                                           </tr>
                                        <% } %>
                                     <% } %>
                                  </tbody>
                               </table>
                            </div>
                         </div><!-- card-body end// -->
                    </div> <!-- card end// -->
                </div>
                
            </div>
            
            
             
             
             

            
        </section> <!-- content-main end// -->
        <!-- <div class="container">
        
        <div class="row">
            <div class="col-md-3">
               
            </div> -->
       
    </main>
    <script src="assets/js/vendors/jquery-3.6.0.min.js"></script>
    <script src="assets/js/vendors/bootstrap.bundle.min.js"></script>
    <script src="assets/js/vendors/select2.min.js"></script>
    <script src="assets/js/vendors/perfect-scrollbar.js"></script>
    <script src="assets/js/vendors/jquery.fullscreen.min.js"></script>
    <!-- Main Script -->
    <script src="assets/js/main.js" type="text/javascript"></script>
    <!-- if choose custom date  the date box will come -->
    <!-- <script>
        function toggleDateFields() {
            var reportType = document.getElementById('report-type').value;
            var dateRangeDiv = document.getElementById('date-range');
        
            if (reportType === 'custom') {
                dateRangeDiv.style.display = 'block'; // Show date fields
            } else {
                dateRangeDiv.style.display = 'none';  // Hide date fields
            }
        }
        </script> -->
        <script>
            function toggleDateFields() {
                const reportType = document.getElementById('report-type').value;
                document.getElementById('custom-date-fields').style.display = reportType === 'custom' ? 'flex' : 'none';
            }
            
            function submitReportForm() {
                const reportType = document.getElementById('report-type').value;
                const startDate = document.getElementById('start-date').value;
                const endDate = document.getElementById('end-date').value;
                let query = `reportType=${reportType}`;
            
                if (reportType === 'custom' && startDate && endDate) {
                    query += `&startDate=${startDate}&endDate=${endDate}`;
                }
                
                window.location.href = `/admin/salesReport?${query}`;
            }
            </script>



<script>
    async function exportToPDF() {
       try {
      
        async function exportToPDF() {
   const { jsPDF } = window.jspdf;  
   let doc = new jsPDF();
   const table = document.getElementById("report-table");

   // Use html2canvas to capture the table as an image
   await html2canvas(table, { scale: 2 }).then((canvas) => {
      const imgData = canvas.toDataURL("image/png");
      const imgProps = doc.getImageProperties(imgData);
      const pdfWidth = doc.internal.pageSize.getWidth();
      const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;

      doc.text("Sales Report", 14, 15);
      doc.addImage(imgData, "PNG", 0, 20, pdfWidth, pdfHeight);
      doc.save("Sales_Report.pdf");
   });
}

 
          // Save the PDF
          doc.save("Sales_Report.pdf");
       } catch (error) {
          console.error("Error generating PDF:", error);
          alert("Failed to export PDF. Please check the console for errors.");
       }
    }
 
    async function exportToExcel() {
       try {
          const table = document.getElementById('report-table');
          const workbook = XLSX.utils.table_to_book(table, { sheet: "Sales Report" });
          XLSX.writeFile(workbook, "Sales_Report.xlsx");
       } catch (error) {
          console.error("Error generating Excel file:", error);
          alert("Failed to export Excel. Please check the console for errors.");
       }
    }
 </script>
 
 
 
 
            
</body>


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/page-categories.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:33:21 GMT -->
</html>